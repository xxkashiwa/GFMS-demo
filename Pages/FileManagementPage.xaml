<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="GFMS.Pages.FileManagementPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:GFMS.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer>
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- 页面标题 -->
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="档案材料管理" 
                          FontSize="32" 
                          FontWeight="Bold"
                          Margin="0,0,0,10"/>
                <TextBlock Text="上传、审核和归档毕业生档案材料" 
                          FontSize="14" 
                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </StackPanel>

            <!-- 主要内容区域 -->
            <Grid Grid.Row="1">
                <Pivot x:Name="FileManagementPivot">
                    
                    <!-- 材料上传标签页 -->
                    <PivotItem Header="材料上传">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- 上传操作区 -->
                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="10">
                                    <ComboBox PlaceholderText="选择学生" Width="200" x:Name="StudentSelector">
                                        <ComboBoxItem Content="张三 (2021001)"/>
                                        <ComboBoxItem Content="李四 (2021002)"/>
                                        <ComboBoxItem Content="王五 (2021003)"/>
                                    </ComboBox>
                                    <ComboBox PlaceholderText="材料类型" Width="150" x:Name="MaterialTypeSelector">
                                        <ComboBoxItem Content="毕业生登记表"/>
                                        <ComboBoxItem Content="体检表"/>
                                        <ComboBoxItem Content="实习报告"/>
                                        <ComboBoxItem Content="成绩单"/>
                                        <ComboBoxItem Content="奖学金证书"/>
                                        <ComboBoxItem Content="其他材料"/>
                                    </ComboBox>
                                    <Button Content="批量上传" Style="{StaticResource AccentButtonStyle}" Click="BatchUploadButton_Click"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                                    <Button Click="DownloadTemplateButton_Click">
                                        <StackPanel Orientation="Horizontal" Spacing="5">
                                            <FontIcon Glyph="&#xE896;" FontSize="14"/>
                                            <TextBlock Text="下载模板"/>
                                        </StackPanel>
                                    </Button>
                                    <Button Click="UploadInstructionButton_Click">
                                        <StackPanel Orientation="Horizontal" Spacing="5">
                                            <FontIcon Glyph="&#xE946;" FontSize="14"/>
                                            <TextBlock Text="上传说明"/>
                                        </StackPanel>
                                    </Button>
                                </StackPanel>
                            </Grid>

                            <!-- 上传区域和文件列表 -->
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="400"/>
                                </Grid.ColumnDefinitions>

                                <!-- 左侧文件列表 -->
                                <Border Grid.Column="0" 
                                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                       CornerRadius="8" 
                                       Padding="0"
                                       Margin="0,0,10,0">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- 文件列表标题 -->
                                        <Grid Grid.Row="0" 
                                             Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                                             Padding="15,10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="50"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="100"/>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="100"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Grid.Column="0" Text="类型" FontWeight="SemiBold"/>
                                            <TextBlock Grid.Column="1" Text="文件名" FontWeight="SemiBold"/>
                                            <TextBlock Grid.Column="2" Text="学生" FontWeight="SemiBold"/>
                                            <TextBlock Grid.Column="3" Text="大小" FontWeight="SemiBold"/>
                                            <TextBlock Grid.Column="4" Text="状态" FontWeight="SemiBold"/>
                                            <TextBlock Grid.Column="5" Text="操作" FontWeight="SemiBold"/>
                                        </Grid>

                                        <!-- 文件列表 -->
                                        <ListView Grid.Row="1" x:Name="UploadedFilesList">
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid Padding="15,10" Height="50">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="50"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="120"/>
                                                            <ColumnDefinition Width="100"/>
                                                            <ColumnDefinition Width="80"/>
                                                            <ColumnDefinition Width="100"/>
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <FontIcon Grid.Column="0" 
                                                                 Glyph="&#xE8A5;" 
                                                                 Foreground="#4CAF50"
                                                                 FontSize="16"
                                                                 HorizontalAlignment="Center"/>
                                                        <TextBlock Grid.Column="1" 
                                                                  Text="毕业生登记表.pdf" 
                                                                  VerticalAlignment="Center"/>
                                                        <TextBlock Grid.Column="2" 
                                                                  Text="张三" 
                                                                  VerticalAlignment="Center"/>
                                                        <TextBlock Grid.Column="3" 
                                                                  Text="2.3 MB" 
                                                                  VerticalAlignment="Center"/>
                                                        <Border Grid.Column="4" 
                                                               Background="#4CAF50" 
                                                               CornerRadius="8" 
                                                               Padding="6,2"
                                                               HorizontalAlignment="Center">
                                                            <TextBlock Text="已上传" 
                                                                      Foreground="White" 
                                                                      FontSize="11"/>
                                                        </Border>
                                                        <StackPanel Grid.Column="5" 
                                                                   Orientation="Horizontal" 
                                                                   Spacing="5">
                                                            <Button Content="预览" 
                                                                   Style="{StaticResource AccentButtonStyle}"
                                                                   FontSize="11"
                                                                   Padding="8,4"
                                                                   Click="PreviewFileButton_Click"/>
                                                            <Button Content="删除" 
                                                                   FontSize="11"
                                                                   Padding="8,4"
                                                                   Click="DeleteFileButton_Click"/>
                                                        </StackPanel>
                                                    </Grid>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Grid>
                                </Border>

                                <!-- 右侧上传区域 -->
                                <Border Grid.Column="1" 
                                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                       CornerRadius="8" 
                                       Padding="20"
                                       Margin="10,0,0,0">
                                    <StackPanel Spacing="20">
                                        <TextBlock Text="文件上传" 
                                                  FontSize="18" 
                                                  FontWeight="SemiBold"/>

                                        <!-- 拖拽上传区域 -->
                                        <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                                               BorderBrush="{ThemeResource SystemAccentColor}"
                                               BorderThickness="2"
                                               CornerRadius="8"
                                               Height="150"
                                               AllowDrop="True">
                                            <StackPanel HorizontalAlignment="Center" 
                                                       VerticalAlignment="Center"
                                                       Spacing="10">
                                                <FontIcon Glyph="&#xE8E5;" 
                                                         FontSize="32"
                                                         Foreground="{ThemeResource SystemAccentColor}"/>
                                                <TextBlock Text="拖拽文件到这里" 
                                                          FontSize="16"
                                                          HorizontalAlignment="Center"/>
                                                <TextBlock Text="或" 
                                                          FontSize="12"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                          HorizontalAlignment="Center"/>
                                                <Button Content="选择文件" 
                                                       Style="{StaticResource AccentButtonStyle}"
                                                       Click="SelectFileButton_Click"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- 上传进度 -->
                                        <StackPanel Spacing="10">
                                            <TextBlock Text="上传进度" FontWeight="SemiBold"/>
                                            <ProgressBar x:Name="UploadProgressBar" 
                                                        Value="65" 
                                                        Maximum="100"
                                                        Height="8"/>
                                            <TextBlock Text="正在上传：实习报告.pdf (65%)" 
                                                      FontSize="12"
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                        </StackPanel>

                                        <!-- 材料要求说明 -->
                                        <StackPanel Spacing="10">
                                            <TextBlock Text="上传要求" FontWeight="SemiBold"/>
                                            <Border Background="{ThemeResource InfoBarInformationalSeverityBackgroundBrush}"
                                                   CornerRadius="6"
                                                   Padding="12">
                                                <StackPanel Spacing="5">
                                                    <TextBlock Text="• 文件格式：PDF、DOC、DOCX、JPG、PNG" 
                                                              FontSize="12"/>
                                                    <TextBlock Text="• 文件大小：不超过 10MB" 
                                                              FontSize="12"/>
                                                    <TextBlock Text="• 文件名称：请使用规范命名" 
                                                              FontSize="12"/>
                                                    <TextBlock Text="• 扫描清晰度：300DPI以上" 
                                                              FontSize="12"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>

                                        <!-- 快速操作 -->
                                        <StackPanel Spacing="10">
                                            <TextBlock Text="快速操作" FontWeight="SemiBold"/>
                                            <StackPanel Spacing="8">
                                                <Button Content="批量下载模板" 
                                                       HorizontalAlignment="Stretch"
                                                       Click="BatchDownloadTemplateButton_Click"/>
                                                <Button Content="查看上传历史" 
                                                       HorizontalAlignment="Stretch"
                                                       Click="ViewUploadHistoryButton_Click"/>
                                                <Button Content="导出文件清单" 
                                                       HorizontalAlignment="Stretch"
                                                       Click="ExportFileListButton_Click"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Grid>
                    </PivotItem>

                    <!-- 材料审核标签页 -->
                    <PivotItem Header="材料审核">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- 审核操作区 -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,0,0,20">
                                <ComboBox PlaceholderText="审核状态" Width="120" SelectionChanged="ReviewStatusComboBox_SelectionChanged">
                                    <ComboBoxItem Content="待审核"/>
                                    <ComboBoxItem Content="已通过"/>
                                    <ComboBoxItem Content="已退回"/>
                                    <ComboBoxItem Content="全部"/>
                                </ComboBox>
                                <ComboBox PlaceholderText="专业筛选" Width="150" SelectionChanged="ReviewMajorComboBox_SelectionChanged">
                                    <ComboBoxItem Content="计算机科学与技术"/>
                                    <ComboBoxItem Content="软件工程"/>
                                    <ComboBoxItem Content="网络工程"/>
                                </ComboBox>
                                <Button Content="批量审核" Style="{StaticResource AccentButtonStyle}" Click="BatchReviewButton_Click"/>
                                <Button Content="导出报告" Click="ExportReportButton_Click"/>
                            </StackPanel>

                            <!-- 审核列表和详情 -->
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="350"/>
                                </Grid.ColumnDefinitions>

                                <!-- 左侧待审核列表 -->
                                <Border Grid.Column="0" 
                                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                       CornerRadius="8" 
                                       Padding="0"
                                       Margin="0,0,10,0">
                                    <ListView x:Name="ReviewFilesList">
                                        <ListView.Header>
                                            <Grid Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                                                 Padding="15,10">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="120"/>
                                                    <ColumnDefinition Width="150"/>
                                                    <ColumnDefinition Width="120"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0" Text="学号" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="1" Text="姓名" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="2" Text="材料类型" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="3" Text="上传时间" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="4" Text="状态" FontWeight="SemiBold"/>
                                                <TextBlock Grid.Column="5" Text="操作" FontWeight="SemiBold"/>
                                            </Grid>
                                        </ListView.Header>
                                        
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Padding="15,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="150"/>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="2021001" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="1" Text="张三" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="2" Text="毕业生登记表" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="3" Text="2024-01-15" VerticalAlignment="Center"/>
                                                    <Border Grid.Column="4" 
                                                           Background="#FF9800" 
                                                           CornerRadius="8" 
                                                           Padding="6,2"
                                                           HorizontalAlignment="Center">
                                                        <TextBlock Text="待审核" 
                                                                  Foreground="White" 
                                                                  FontSize="11"/>
                                                    </Border>
                                                    <Button Grid.Column="5" 
                                                           Content="审核" 
                                                           Style="{StaticResource AccentButtonStyle}"
                                                           FontSize="12"
                                                           Padding="10,4"
                                                           HorizontalAlignment="Left"
                                                           Click="ReviewFileButton_Click"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </Border>

                                <!-- 右侧审核详情面板 -->
                                <Border Grid.Column="1" 
                                       Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                       CornerRadius="8" 
                                       Padding="20"
                                       Margin="10,0,0,0">
                                    <ScrollViewer>
                                        <StackPanel Spacing="15">
                                            <TextBlock Text="材料审核" 
                                                      FontSize="18" 
                                                      FontWeight="SemiBold"/>
                                            
                                            <!-- 学生信息 -->
                                            <StackPanel Spacing="8">
                                                <TextBlock Text="学生信息" 
                                                          FontSize="14" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="{ThemeResource SystemAccentColor}"/>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="学号：" Margin="0,0,10,5"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="2021001" Margin="0,0,0,5"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="姓名：" Margin="0,0,10,5"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="张三" Margin="0,0,0,5"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="专业：" Margin="0,0,10,0"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="计算机科学与技术"/>
                                                </Grid>
                                            </StackPanel>

                                            <!-- 材料信息 -->
                                            <StackPanel Spacing="8">
                                                <TextBlock Text="材料信息" 
                                                          FontSize="14" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="{ThemeResource SystemAccentColor}"/>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="材料类型：" Margin="0,0,10,5"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="毕业生登记表" Margin="0,0,0,5"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="文件名：" Margin="0,0,10,5"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="毕业生登记表.pdf" Margin="0,0,0,5"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="0" Text="文件大小：" Margin="0,0,10,5"/>
                                                    <TextBlock Grid.Row="2" Grid.Column="1" Text="2.3 MB" Margin="0,0,0,5"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="0" Text="上传时间：" Margin="0,0,10,0"/>
                                                    <TextBlock Grid.Row="3" Grid.Column="1" Text="2024-01-15 14:30"/>
                                                </Grid>
                                            </StackPanel>

                                            <!-- 文件预览 -->
                                            <StackPanel Spacing="8">
                                                <TextBlock Text="文件预览" 
                                                          FontSize="14" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="{ThemeResource SystemAccentColor}"/>
                                                <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                                                       CornerRadius="6"
                                                       Height="120"
                                                       Padding="10">
                                                    <StackPanel HorizontalAlignment="Center" 
                                                               VerticalAlignment="Center"
                                                               Spacing="8">
                                                        <FontIcon Glyph="&#xE8A5;" 
                                                                 FontSize="24"
                                                                 Foreground="{ThemeResource SystemAccentColor}"/>
                                                        <TextBlock Text="点击预览文件" 
                                                                  FontSize="12"
                                                                  HorizontalAlignment="Center"/>
                                                        <Button Content="打开预览" 
                                                               Style="{StaticResource AccentButtonStyle}"
                                                               FontSize="12"
                                                               Click="OpenPreviewButton_Click"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>

                                            <!-- 审核意见 -->
                                            <StackPanel Spacing="8">
                                                <TextBlock Text="审核意见" 
                                                          FontSize="14" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="{ThemeResource SystemAccentColor}"/>
                                                <TextBox PlaceholderText="请输入审核意见..." 
                                                        AcceptsReturn="True"
                                                        Height="80"/>
                                            </StackPanel>

                                            <!-- 审核操作 -->
                                            <StackPanel Spacing="10">
                                                <TextBlock Text="审核结果" 
                                                          FontSize="14" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="{ThemeResource SystemAccentColor}"/>
                                                <StackPanel Orientation="Horizontal" Spacing="10">
                                                    <Button Content="通过" 
                                                           Background="#4CAF50"
                                                           Foreground="White"
                                                           Padding="15,8"
                                                           Click="ApproveButton_Click"/>
                                                    <Button Content="退回" 
                                                           Background="#F44336"
                                                           Foreground="White"
                                                           Padding="15,8"
                                                           Click="RejectButton_Click"/>
                                                    <Button Content="暂存" 
                                                           Padding="15,8"
                                                           Click="SaveDraftButton_Click"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </StackPanel>
                                    </ScrollViewer>
                                </Border>
                            </Grid>
                        </Grid>
                    </PivotItem>

                    <!-- 材料归档标签页 -->
                    <PivotItem Header="材料归档">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- 归档操作区 -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,0,0,20">
                                <Button Content="生成电子档案袋" Style="{StaticResource AccentButtonStyle}" Click="GenerateArchiveButton_Click"/>
                                <Button Content="批量归档" Click="BatchArchiveButton_Click"/>
                                <ComboBox PlaceholderText="归档状态" Width="120" SelectionChanged="ArchiveStatusComboBox_SelectionChanged">
                                    <ComboBoxItem Content="待归档"/>
                                    <ComboBoxItem Content="已归档"/>
                                    <ComboBoxItem Content="全部"/>
                                </ComboBox>
                                <Button Content="导出统计" Click="ExportStatisticsButton_Click"/>
                            </StackPanel>

                            <!-- 归档列表 -->
                            <Border Grid.Row="1" 
                                   Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                                   CornerRadius="8" 
                                   Padding="0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- 归档列表标题 -->
                                    <Grid Grid.Row="0" 
                                         Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}" 
                                         Padding="15,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="200"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="学号" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Column="1" Text="姓名" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Column="2" Text="专业" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Column="3" Text="材料数量" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Column="4" Text="归档时间" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Column="5" Text="状态" FontWeight="SemiBold"/>
                                        <TextBlock Grid.Column="6" Text="操作" FontWeight="SemiBold"/>
                                    </Grid>

                                    <!-- 归档列表内容 -->
                                    <ListView Grid.Row="1" x:Name="ArchivedFilesList">
                                        <ListView.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Padding="15,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="200"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="120"/>
                                                        <ColumnDefinition Width="100"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="2021001" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="1" Text="张三" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="2" Text="计算机科学与技术" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="3" Text="8/8" VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="4" Text="2024-01-20" VerticalAlignment="Center"/>
                                                    <Border Grid.Column="5" 
                                                           Background="#4CAF50" 
                                                           CornerRadius="8" 
                                                           Padding="6,2"
                                                           HorizontalAlignment="Center">
                                                        <TextBlock Text="已归档" 
                                                                  Foreground="White" 
                                                                  FontSize="11"/>
                                                    </Border>
                                                    <StackPanel Grid.Column="6" 
                                                               Orientation="Horizontal" 
                                                               Spacing="5">
                                                        <Button Content="查看档案袋" 
                                                               Style="{StaticResource AccentButtonStyle}"
                                                               FontSize="11"
                                                               Padding="8,4"
                                                               Click="ViewArchiveButton_Click"/>
                                                        <Button Content="下载" 
                                                               FontSize="11"
                                                               Padding="8,4"
                                                               Click="DownloadArchiveButton_Click"/>
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </ListView.ItemTemplate>
                                    </ListView>
                                </Grid>
                            </Border>
                        </Grid>
                    </PivotItem>
                </Pivot>
            </Grid>
        </Grid>
    </ScrollViewer>
</Page>
